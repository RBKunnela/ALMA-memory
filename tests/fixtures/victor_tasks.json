[
  {
    "task_id": "victor-001",
    "task_type": "authentication_patterns",
    "description": "Test user authentication endpoint",
    "endpoint": "/api/v1/auth/login",
    "method": "POST",
    "test_scenarios": [
      {
        "name": "valid_credentials",
        "payload": {"email": "test@example.com", "password": "password123"},
        "expected_status": 200,
        "expected_response": {"token": "string", "user": "object"}
      },
      {
        "name": "invalid_password",
        "payload": {"email": "test@example.com", "password": "wrong"},
        "expected_status": 401,
        "expected_response": {"error": "invalid_credentials"}
      },
      {
        "name": "missing_email",
        "payload": {"password": "password123"},
        "expected_status": 422,
        "expected_response": {"error": "validation_error"}
      },
      {
        "name": "rate_limited",
        "action": "send 10 requests in 1 second",
        "expected_status": 429,
        "expected_response": {"error": "rate_limit_exceeded"}
      }
    ]
  },
  {
    "task_id": "victor-002",
    "task_type": "api_design_patterns",
    "description": "Test CRUD operations for users",
    "base_endpoint": "/api/v1/users",
    "operations": [
      {
        "name": "create_user",
        "method": "POST",
        "endpoint": "/api/v1/users",
        "payload": {"name": "Test User", "email": "new@example.com"},
        "expected_status": 201,
        "expected_headers": {"Location": "/api/v1/users/{id}"}
      },
      {
        "name": "get_user",
        "method": "GET",
        "endpoint": "/api/v1/users/{id}",
        "expected_status": 200,
        "expected_response": {"id": "string", "name": "string", "email": "string"}
      },
      {
        "name": "update_user",
        "method": "PATCH",
        "endpoint": "/api/v1/users/{id}",
        "payload": {"name": "Updated Name"},
        "expected_status": 200
      },
      {
        "name": "delete_user",
        "method": "DELETE",
        "endpoint": "/api/v1/users/{id}",
        "expected_status": 204
      },
      {
        "name": "get_deleted_user",
        "method": "GET",
        "endpoint": "/api/v1/users/{id}",
        "expected_status": 404
      }
    ]
  },
  {
    "task_id": "victor-003",
    "task_type": "error_handling",
    "description": "Test API error responses",
    "scenarios": [
      {
        "name": "not_found",
        "endpoint": "/api/v1/resources/nonexistent",
        "method": "GET",
        "expected_status": 404,
        "expected_response": {
          "error": "not_found",
          "message": "Resource not found",
          "request_id": "string"
        }
      },
      {
        "name": "validation_error",
        "endpoint": "/api/v1/users",
        "method": "POST",
        "payload": {"invalid": "data"},
        "expected_status": 422,
        "expected_response": {
          "error": "validation_error",
          "details": [{"field": "string", "message": "string"}]
        }
      },
      {
        "name": "internal_error",
        "endpoint": "/api/v1/test/error",
        "method": "GET",
        "expected_status": 500,
        "expected_response": {
          "error": "internal_error",
          "request_id": "string"
        }
      },
      {
        "name": "method_not_allowed",
        "endpoint": "/api/v1/users",
        "method": "PATCH",
        "expected_status": 405,
        "expected_headers": {"Allow": "GET, POST"}
      }
    ]
  },
  {
    "task_id": "victor-004",
    "task_type": "database_query_patterns",
    "description": "Test paginated list endpoint",
    "endpoint": "/api/v1/items",
    "method": "GET",
    "test_scenarios": [
      {
        "name": "default_pagination",
        "params": {},
        "expected_response": {
          "items": "array",
          "meta": {"page": 1, "per_page": 20, "total": "number"}
        }
      },
      {
        "name": "custom_page_size",
        "params": {"page": 2, "per_page": 10},
        "expected_response": {
          "items": "array[10]",
          "meta": {"page": 2, "per_page": 10}
        }
      },
      {
        "name": "sorting",
        "params": {"sort": "created_at", "order": "desc"},
        "expected_result": "items sorted by date descending"
      },
      {
        "name": "filtering",
        "params": {"status": "active", "category": "featured"},
        "expected_result": "only matching items returned"
      }
    ]
  },
  {
    "task_id": "victor-005",
    "task_type": "performance_optimization",
    "description": "Test API response times",
    "endpoints": [
      {
        "endpoint": "/api/v1/health",
        "method": "GET",
        "max_response_time_ms": 50,
        "description": "health check should be fast"
      },
      {
        "endpoint": "/api/v1/users",
        "method": "GET",
        "max_response_time_ms": 200,
        "description": "list with default pagination"
      },
      {
        "endpoint": "/api/v1/search",
        "method": "POST",
        "payload": {"query": "test"},
        "max_response_time_ms": 500,
        "description": "search with caching"
      },
      {
        "endpoint": "/api/v1/reports/generate",
        "method": "POST",
        "max_response_time_ms": 5000,
        "async_expected": true,
        "description": "long-running task returns job ID"
      }
    ]
  },
  {
    "task_id": "victor-006",
    "task_type": "authentication_patterns",
    "description": "Test JWT token flow",
    "scenarios": [
      {
        "name": "obtain_token",
        "endpoint": "/api/v1/auth/token",
        "method": "POST",
        "payload": {"email": "user@example.com", "password": "password"},
        "expected_response": {
          "access_token": "string",
          "refresh_token": "string",
          "expires_in": 3600
        }
      },
      {
        "name": "use_token",
        "endpoint": "/api/v1/protected",
        "method": "GET",
        "headers": {"Authorization": "Bearer {access_token}"},
        "expected_status": 200
      },
      {
        "name": "expired_token",
        "endpoint": "/api/v1/protected",
        "method": "GET",
        "headers": {"Authorization": "Bearer {expired_token}"},
        "expected_status": 401,
        "expected_response": {"error": "token_expired"}
      },
      {
        "name": "refresh_token",
        "endpoint": "/api/v1/auth/refresh",
        "method": "POST",
        "payload": {"refresh_token": "{refresh_token}"},
        "expected_status": 200,
        "expected_response": {"access_token": "string"}
      }
    ]
  },
  {
    "task_id": "victor-007",
    "task_type": "api_design_patterns",
    "description": "Test webhook endpoints",
    "scenarios": [
      {
        "name": "register_webhook",
        "endpoint": "/api/v1/webhooks",
        "method": "POST",
        "payload": {
          "url": "https://example.com/hook",
          "events": ["user.created", "user.updated"]
        },
        "expected_status": 201,
        "expected_response": {"id": "string", "secret": "string"}
      },
      {
        "name": "verify_signature",
        "description": "incoming webhook should have valid signature",
        "headers": {"X-Signature": "{computed_hmac}"},
        "expected_result": "signature validation passes"
      },
      {
        "name": "retry_on_failure",
        "description": "webhook delivery retries on 5xx",
        "expected_retries": 3,
        "retry_delays": [60, 300, 900]
      }
    ]
  },
  {
    "task_id": "victor-008",
    "task_type": "database_query_patterns",
    "description": "Test batch operations",
    "scenarios": [
      {
        "name": "batch_create",
        "endpoint": "/api/v1/items/batch",
        "method": "POST",
        "payload": {"items": ["array of items"]},
        "expected_status": 201,
        "expected_response": {
          "created": "number",
          "failed": "number",
          "errors": "array"
        }
      },
      {
        "name": "batch_update",
        "endpoint": "/api/v1/items/batch",
        "method": "PATCH",
        "payload": {"updates": [{"id": "1", "status": "active"}]},
        "expected_status": 200
      },
      {
        "name": "batch_delete",
        "endpoint": "/api/v1/items/batch",
        "method": "DELETE",
        "payload": {"ids": ["1", "2", "3"]},
        "expected_status": 200,
        "expected_response": {"deleted": 3}
      }
    ]
  },
  {
    "task_id": "victor-009",
    "task_type": "error_handling",
    "description": "Test database connection errors",
    "scenarios": [
      {
        "name": "connection_timeout",
        "simulation": "slow database response",
        "expected_status": 503,
        "expected_response": {
          "error": "service_unavailable",
          "retry_after": 30
        }
      },
      {
        "name": "connection_lost",
        "simulation": "database connection dropped",
        "expected_result": "graceful degradation with cached data"
      },
      {
        "name": "transaction_rollback",
        "simulation": "constraint violation during batch",
        "expected_result": "all changes rolled back"
      }
    ]
  },
  {
    "task_id": "victor-010",
    "task_type": "performance_optimization",
    "description": "Test caching behavior",
    "scenarios": [
      {
        "name": "cache_hit",
        "endpoint": "/api/v1/cached-resource",
        "method": "GET",
        "expected_headers": {"X-Cache": "HIT"},
        "expected_response_time_ms": 10
      },
      {
        "name": "cache_miss",
        "endpoint": "/api/v1/cached-resource",
        "method": "GET",
        "params": {"bust": "true"},
        "expected_headers": {"X-Cache": "MISS"}
      },
      {
        "name": "conditional_get",
        "endpoint": "/api/v1/resource",
        "method": "GET",
        "headers": {"If-None-Match": "{etag}"},
        "expected_status": 304
      },
      {
        "name": "cache_invalidation",
        "endpoint": "/api/v1/resource",
        "method": "PUT",
        "expected_result": "cache cleared for resource"
      }
    ]
  }
]
